############################################################
# ðŸ“˜ æ–‡ä»¶è¯´æ˜Žï¼š
# æœ¬æ–‡ä»¶å®žçŽ°çš„åŠŸèƒ½ï¼šé¡¹ç›®è·¯å¾„è§£æžå·¥å…·
#
# ðŸ“‹ ç¨‹åºæ•´ä½“ä¼ªä»£ç ï¼ˆä¸­æ–‡ï¼‰ï¼š
# 1. åˆå§‹åŒ–ä¸»è¦ä¾èµ–ä¸Žå˜é‡
# 2. åŠ è½½è¾“å…¥æ•°æ®æˆ–æŽ¥æ”¶å¤–éƒ¨è¯·æ±‚
# 3. æ‰§è¡Œä¸»è¦é€»è¾‘æ­¥éª¤ï¼ˆå¦‚è®¡ç®—ã€å¤„ç†ã€è®­ç»ƒã€æ¸²æŸ“ç­‰ï¼‰
# 4. è¾“å‡ºæˆ–è¿”å›žç»“æžœ
# 5. å¼‚å¸¸å¤„ç†ä¸Žèµ„æºé‡Šæ”¾
#
# ðŸ”„ ç¨‹åºæµç¨‹å›¾ï¼ˆé€»è¾‘æµï¼‰ï¼š
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  è¾“å…¥æ•°æ® â”‚
# â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
#       â†“
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  æ ¸å¿ƒå¤„ç†é€»è¾‘ â”‚
# â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
#       â†“
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  è¾“å‡ºç»“æžœ â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# ðŸ“Š æ•°æ®ç®¡é“è¯´æ˜Žï¼š
# æ•°æ®æµå‘ï¼šè¾“å…¥æº â†’ æ•°æ®æ¸…æ´—/è½¬æ¢ â†’ æ ¸å¿ƒç®—æ³•æ¨¡å— â†’ è¾“å‡ºç›®æ ‡ï¼ˆæ–‡ä»¶ / æŽ¥å£ / ç»ˆç«¯ï¼‰
#
# ðŸ§© æ–‡ä»¶ç»“æž„ï¼š
# - ä¾èµ–ï¼ˆæ ‡å‡†åº“ï¼‰ï¼š__future__, pathlib, typing
# - ä¾èµ–ï¼ˆç¬¬ä¸‰æ–¹ï¼‰ï¼šæ— 
# - ä¾èµ–ï¼ˆæœ¬åœ°ï¼‰ï¼šæ— 
#
# ðŸ•’ åˆ›å»ºæ—¶é—´ï¼š2025-12-19
############################################################

"""
é¡¹ç›®è·¯å¾„è§£æžå·¥å…·

ç›®æ ‡ï¼š
- ä¸ä¾èµ–æ¨¡å—æ‰€åœ¨ç›®å½•å±‚çº§ï¼ˆé¿å…ç§»åŠ¨ç›®å½•åŽè·¯å¾„å¤±æ•ˆï¼‰
- ä»¥ä»“åº“æ ¹ç›®å½•ä¸ºåŸºå‡†ï¼Œç»Ÿä¸€ç”Ÿæˆ reports/logs/data ç­‰è·¯å¾„
"""

from __future__ import annotations

from pathlib import Path
from typing import Optional


def find_repo_root(start: Optional[Path] = None) -> Path:
    """
    ä»ŽæŒ‡å®šè·¯å¾„å‘ä¸ŠæŸ¥æ‰¾åŒ…å« .git çš„ç›®å½•ä½œä¸ºä»“åº“æ ¹ç›®å½•ã€‚
    æ‰¾ä¸åˆ°æ—¶å›žé€€åˆ°å½“å‰å·¥ä½œç›®å½•ã€‚
    """
    probe = (start or Path(__file__)).resolve()
    for parent in [probe, *probe.parents]:
        if (parent / ".git").exists():
            return parent

    cwd = Path.cwd().resolve()
    for parent in [cwd, *cwd.parents]:
        if (parent / ".git").exists():
            return parent

    return cwd


PROJECT_ROOT: Path = find_repo_root()


def project_path(*parts: str) -> Path:
    """ä»¥ä»“åº“æ ¹ç›®å½•ä¸ºåŸºå‡†æ‹¼æŽ¥è·¯å¾„ã€‚"""
    return PROJECT_ROOT.joinpath(*parts)


__all__ = ["PROJECT_ROOT", "find_repo_root", "project_path"]
