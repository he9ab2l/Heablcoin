# Heablcoin 项目 AI 交接提示词

> 用途：给新 AI 接管项目时注入的完整上下文，确保无缝衔接

---

## 1. 项目基础信息

- **项目名称**：Heablcoin 🪙
- **版本**：v0.1.0（初版）
- **定位**：符合 Model Context Protocol (MCP) 的智能交易助手
- **技术栈**：Python 3.8+、pandas、ccxt（可选）、MCP 协议
- **核心功能**：市场分析、交易执行、风险管理、通知推送、回测引擎

## 2. 当前项目状态

### 2.1 已完成的核心模块

| 模块 | 状态 | 关键文件 | 说明 |
|------|------|----------|------|
| 环境变量管理 | ✅ 完成 | `utils/env_helpers.py` | 统一的 env_str/env_int/env_float/env_bool/parse_symbols |
| 交易所适配器 | ✅ 完成 | `utils/exchange_adapter.py` | Binance 实现化，OKX/Bybit 桩代码 |
| 风险管理 | ✅ 完成 | `utils/risk_management.py` | 仓位计算、追踪止损 |
| 回测引擎 | ✅ 完成 | `utils/backtesting.py` | 基础策略回测 |
| 通知系统 | ✅ 完成 | `utils/notifier.py` | 控制台/Telegram 通道 |
| 日志系统 | ✅ 完成 | `utils/smart_logger.py` | 结构化 JSON 输出，多通道 |
| 缓存系统 | ✅ 完成 | `utils/smart_cache.py` | TTL 缓存，统计功能 |
| 复盘机制 | ✅ 完成 | `lesson/` | 模板 + record_lesson.py 脚本 |
| 存储适配 | ✅ 完成 | `storage/` | 文件/Notion/邮件适配器 |
| 报告生成 | ✅ 完成 | `report/flexible_report/` | 灵活报告服务 |

### 2.2 测试覆盖

- **单元测试**：10 个文件，全部通过
- **集成测试**：2 个文件，全部通过
- **测试套件**：`tests/run_tests.py` 支持 --quick/unit/integration/all

### 2.3 最近重构记录

1. **环境变量函数抽取**（2025-12-18 15:15）
   - 将重复的 `_env_*` 函数统一到 `utils/env_helpers.py`
   - 更新 `Heablcoin.py`、`learning/core.py`、测试文件引用

2. **包导出规范化**（2025-12-18 14:45）
   - 统一关键包的 `__init__.py` 使用相对导入
   - 明确 `__all__` 导出列表

## 3. 项目结构概览

```
Heablcoin/
├── Heablcoin.py              # 主入口，MCP 服务器
├── utils/                   # 工具模块
│   ├── env_helpers.py       # 环境变量工具（新增）
│   ├── smart_logger.py      # 智能日志系统
│   ├── smart_cache.py       # 缓存系统
│   └── [其他工具模块]
├── tests/                  # 测试套件
│   ├── run_tests.py        # 统一测试运行器
│   └── test_*.py          # 单元测试文件
├── lesson/                 # 复盘机制
│   ├── TEMPLATE.md         # 复盘模板
│   └── record_lesson.py    # 复盘脚本
├── docs/                  # 文档
│   ├── user/              # 用户文档
│   └── developer/         # 开发者文档
├── storage/               # 存储适配层
├── market_analysis/       # 市场分析
├── orchestration/         # 任务编排
├── cloud/               # 云服务
└── [其他业务模块]
```

## 4. 配置要求

### 4.1 环境变量（.env）

```bash
# 交易所配置
BINANCE_API_KEY=your_api_key
BINANCE_SECRET=your_secret
USE_TESTNET=true

# 通知配置
NOTIFY_TRADE_EXECUTION=true
NOTIFY_PRICE_ALERTS=true
NOTIFY_DAILY_REPORT=true
NOTIFY_SYSTEM_ERRORS=true

# 其他配置
LOG_LEVEL=INFO
ALLOWED_SYMBOLS=BTC/USDT,ETH/USDT,BNB/USDT
```

### 4.2 MCP 配置

```json
{
  "mcpServers": {
    "heablcoin": {
      "command": "python",
      "args": ["D:/MCP/Heablcoin.py"]
    }
  }
}
```

## 5. 开发规范

### 5.1 代码风格

- 遵循 KISS/YAGNI/SOLID 原则
- 优先使用 `utils/env_helpers` 中的环境变量函数
- 新增工具模块需提供单元测试
- 包导出使用相对导入 + 明确 `__all__`

### 5.2 测试要求

- 新功能必须添加单元测试
- 运行 `python tests/run_tests.py all` 确保全量通过
- 外部依赖需 mock，避免真实网络调用

### 5.3 文档更新

- 重要变更需更新 `历史记录.json`
- 项目进度更新 `任务进度.json`
- 复盘记录放入 `lesson/` 目录

## 6. 待办事项

### 6.1 高优先级

- [ ] 无（当前所有 P0 问题已解决）

### 6.2 中优先级

- [ ] 考虑优化文件头模板注释（35 行模板，价值待评估）
- [ ] 完善 README 中的 API 文档链接

### 6.3 低优先级

- [ ] 优化部分 `noqa` 注释
- [ ] 考虑添加性能基准测试

## 7. 关键决策记录

1. **环境变量统一**：避免在多处重复定义，提升可维护性
2. **相对导入**：包内部使用相对导入，减少耦合
3. **测试隔离**：所有外部依赖 mock，确保测试稳定
4. **结构化日志**：JSON 格式便于日志分析工具处理

## 8. 接管指令

如果你是新接管的 AI，请按以下步骤操作：

1. **阅读本文档**，理解项目现状
2. **运行测试**：`python tests/run_tests.py --quick` 验证环境
3. **检查 .env**：确认必要的环境变量已配置
4. **查看最近提交**：`git log --oneline -5` 了解最新变更
5. **开始工作**：根据用户需求继续开发

## 9. 紧急联系

- **项目仓库**：https://github.com/he9ab2l/Heablcoin.git
- **分支**：`v2test`（当前开发分支）
- **关键文档**：`docs/developer/` 目录

---

**生成时间**：2025-12-18 15:40
**版本**：v1.0（交接版）
**适用 AI**：Claude 3.5+ / GPT-4o / Gemini 1.5 Pro
