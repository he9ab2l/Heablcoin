# 🗺️ Heablcoin 代码使用全景图

> ✅ 最新版本：`docs/user/代码使用全景图_按时间轴_20251219.md`  
> ⚠️ 本文件作为历史版本入口，内容可能滞后；请优先阅读上面的最新版本。

> 📅 生成时间：2024-12-18  
> 📦 项目版本：v2.0+  
> 🎯 文档目的：为开发者和用户提供完整的代码结构、数据流向和使用指南

---

## 📑 目录

1. [项目环境与技术栈](#第一部分项目环境与技术栈)
2. [代码使用全景图](#第二部分代码使用全景图)
3. [核心文件清单](#第三部分核心文件清单)
4. [数据流转图](#第四部分数据流转图)
5. [使用说明](#第五部分使用说明)

---

# 第一部分：项目环境与技术栈

## 📦 项目依赖环境

### Python版本要求
- **最低版本**: Python 3.8+
- **推荐版本**: Python 3.10+
- **测试版本**: Python 3.11

### 操作系统支持
| 操作系统 | 支持状态 | 备注 |
|---------|---------|------|
| Windows 10/11 | ✅ 完全支持 | 主要开发平台 |
| macOS | ✅ 完全支持 | 需要 Homebrew |
| Linux (Ubuntu/Debian) | ✅ 完全支持 | 推荐生产环境 |

### 核心依赖库列表

#### 🔧 核心框架
| 库名 | 版本 | 用途 |
|-----|------|------|
| `mcp` | latest | Model Context Protocol 服务端框架 |
| `fastmcp` | latest | MCP 快速开发工具 |

#### 📊 数据处理库
| 库名 | 版本 | 用途 |
|-----|------|------|
| `pandas` | ≥1.5.0 | 数据分析与处理 |
| `numpy` | ≥1.21.0 | 数值计算 |

#### 🌐 网络通信库
| 库名 | 版本 | 用途 |
|-----|------|------|
| `ccxt` | latest | 统一加密货币交易所API |
| `aiohttp` | ≥3.8.0 | 异步HTTP客户端 |

#### 💾 数据库与缓存
| 库名 | 版本 | 用途 |
|-----|------|------|
| `redis` | ≥4.0.0 | 可选，云端任务队列 |

#### 📧 通知与配置
| 库名 | 版本 | 用途 |
|-----|------|------|
| `python-dotenv` | ≥0.19.0 | 环境变量管理 |
| `python-telegram-bot` | ≥20.0 | 可选，Telegram通知 |

#### 🔨 其他工具库
| 库名 | 版本 | 用途 |
|-----|------|------|
| `markdown` | ≥3.3.0 | Markdown渲染 |

---

## 🔧 技术栈与核心库详解

### 1. MCP (Model Context Protocol)
```
用途：与大语言模型（LLM）的标准化通信协议
核心组件：
  - FastMCP Server: 服务端框架
  - Tool Registry: 工具注册系统
  - JSON-RPC: 通信协议
关键应用场景：
  - Claude Desktop 集成
  - Windsurf IDE 集成
  - 自然语言驱动交易分析
```

### 2. CCXT (CryptoCurrency eXchange Trading)
```
用途：统一的加密货币交易所API
核心组件：
  - Exchange 类: 交易所实例
  - fetch_ticker: 获取行情
  - fetch_ohlcv: 获取K线数据
  - create_order: 下单接口
关键应用场景：
  - 实时行情获取
  - 账户余额查询
  - 交易执行
支持交易所：Binance, OKX, Bybit 等 100+ 交易所
```

### 3. Pandas & NumPy
```
用途：数据分析与数值计算
核心组件：
  - DataFrame: 表格数据结构
  - Series: 时间序列
  - rolling/ewm: 滚动计算
关键应用场景：
  - 技术指标计算
  - 历史数据分析
  - 绩效统计
```

---

## 🚀 环境安装指南

### 快速安装命令

```bash
# 1. 克隆项目
git clone https://github.com/your/heablcoin.git
cd heablcoin

# 2. 创建虚拟环境（推荐）
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/macOS
source venv/bin/activate

# 3. 安装依赖
pip install -r requirements.txt

# 4. 可选：安装 Telegram 通知支持
pip install python-telegram-bot

# 5. 配置环境变量
cp .env.example .env
# 编辑 .env 填入你的 API 密钥
```

### 配置文件示例 (.env)

```ini
# === 交易所配置 ===
BINANCE_API_KEY=your_api_key_here
BINANCE_SECRET=your_secret_here
USE_TESTNET=true

# === 通知配置 ===
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password

# === 风控配置 ===
MAX_POSITION_SIZE=1000
ALLOWED_SYMBOLS=BTC/USDT,ETH/USDT

# === 可选：Redis 云端任务 ===
REDIS_URL=redis://localhost:6379
```

### 验证安装方法

```bash
# 快速自检
python tests/run_tests.py --quick

# 完整测试
python tests/run_tests.py all

# 验证 MCP 服务端
python Heablcoin.py
# 应看到 MCP Server 启动日志
```

---

## 💻 系统要求

### 硬件要求
| 项目 | 最低配置 | 推荐配置 |
|-----|---------|---------|
| CPU | 双核 2GHz | 四核 3GHz+ |
| 内存 | 4GB | 8GB+ |
| 磁盘 | 1GB 可用空间 | 10GB SSD |

### 软件要求
| 项目 | 要求 |
|-----|------|
| Python | 3.8+ |
| pip | 最新版 |
| Git | 2.0+ |

### 网络要求
| 用途 | 说明 |
|-----|------|
| 交易所API | 需要访问 Binance 等交易所 |
| MCP通信 | 本地 stdio 通信，无需网络 |
| 云端任务 | 可选，需要 Redis 服务 |

---

# 第二部分：代码使用全景图

## 1. ⚡ 极简版总览（完整流程）

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        Heablcoin 系统架构总览                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                   │
│  │ Claude/IDE  │────▶│ MCP Server  │────▶│  交易所API  │                   │
│  │  (用户端)    │◀────│ Heablcoin   │◀────│  (Binance)  │                   │
│  └─────────────┘     └──────┬──────┘     └─────────────┘                   │
│                             │                                               │
│         ┌───────────────────┼───────────────────┐                          │
│         ▼                   ▼                   ▼                          │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                   │
│  │ 市场分析    │     │ 个人绩效    │     │ 云端任务    │                   │
│  │ Analysis    │     │ Analytics   │     │ Cloud       │                   │
│  └─────────────┘     └─────────────┘     └─────────────┘                   │
│         │                   │                   │                          │
│         ▼                   ▼                   ▼                          │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                   │
│  │ 技术指标    │     │ 交易日志    │     │ Redis队列   │                   │
│  │ 情绪分析    │     │ 风险分析    │     │ AI编排      │                   │
│  │ 信号生成    │     │ 归因分析    │     │ 定时调度    │                   │
│  └─────────────┘     └─────────────┘     └─────────────┘                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 2. 📊 按功能模块展开详细流程

### 🕐 时间轴 1：系统启动阶段

```
┌──────────────────────────────────────────────────────────────┐
│                    系统启动流程                               │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  [00:00] 环境初始化                                          │
│     │                                                        │
│     ├──▶ 加载 .env 环境变量                                  │
│     ├──▶ 配置日志系统                                        │
│     └──▶ 设置 stdout 重定向（保护MCP协议）                    │
│                                                              │
│  [00:01] 模块加载                                            │
│     │                                                        │
│     ├──▶ market_analysis (市场分析)                          │
│     ├──▶ personal_analytics (个人绩效)                       │
│     ├──▶ learning (学习模块)                                 │
│     ├──▶ orchestration (AI编排)                              │
│     ├──▶ cloud (云端任务)                                    │
│     └──▶ report (报告生成)                                   │
│                                                              │
│  [00:02] MCP工具注册                                         │
│     │                                                        │
│     └──▶ 注册 50+ MCP 工具函数                               │
│                                                              │
│  [00:03] 服务就绪                                            │
│     │                                                        │
│     └──▶ 等待 Claude/IDE 连接                                │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

**📂 核心脚本**：
| 脚本 | 功能 | 耗时 |
|-----|------|------|
| `Heablcoin.py` | MCP服务端主入口 | ~2秒 |

**📥 输入**：`.env` 配置文件  
**📤 输出**：MCP Server 就绪状态

---

### 🕐 时间轴 2：市场分析流程

```
┌──────────────────────────────────────────────────────────────┐
│                    市场分析数据管道                           │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────┐                                             │
│  │ 用户请求    │ "分析BTC走势"                               │
│  └──────┬──────┘                                             │
│         ↓                                                    │
│  ┌─────────────┐                                             │
│  │ MCP Tool    │ get_comprehensive_analysis()                │
│  └──────┬──────┘                                             │
│         ↓                                                    │
│  ┌─────────────┐     ┌─────────────┐                        │
│  │ 数据获取    │────▶│ CCXT API    │                        │
│  │ data_provider│◀────│ fetch_ohlcv │                        │
│  └──────┬──────┘     └─────────────┘                        │
│         ↓                                                    │
│  ┌─────────────────────────────────────────────┐            │
│  │              指标计算流水线                   │            │
│  ├─────────────┬─────────────┬─────────────────┤            │
│  │ 趋势指标    │ 动量指标    │ 波动率指标      │            │
│  │ MA/EMA/ADX  │ RSI/MACD    │ ATR/BB          │            │
│  └──────┬──────┴──────┬──────┴────────┬────────┘            │
│         └─────────────┼───────────────┘                      │
│                       ↓                                      │
│  ┌─────────────────────────────────────────────┐            │
│  │              分析模块                        │            │
│  ├─────────────┬─────────────┬─────────────────┤            │
│  │ 技术总结    │ 情绪分析    │ 信号生成        │            │
│  └──────┬──────┴──────┬──────┴────────┬────────┘            │
│         └─────────────┼───────────────┘                      │
│                       ↓                                      │
│  ┌─────────────┐                                             │
│  │ 结果输出    │ JSON / Markdown / 图表                      │
│  └─────────────┘                                             │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

**📂 核心脚本**：
| 脚本 | 功能 |
|-----|------|
| `market_analysis/mcp_tools.py` | MCP工具注册 |
| `market_analysis/core.py` | 分析核心逻辑 |
| `market_analysis/data_provider.py` | 数据获取 |
| `market_analysis/indicators/*.py` | 技术指标计算 |
| `market_analysis/modules/*.py` | 分析子模块 |

**⏱️ 预估耗时**：3-10秒（取决于数据量）

---

### 🕐 时间轴 3：交易执行流程

```
┌──────────────────────────────────────────────────────────────┐
│                    交易执行数据管道                           │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────┐                                             │
│  │ 用户请求    │ "买入0.01 BTC"                              │
│  └──────┬──────┘                                             │
│         ↓                                                    │
│  ┌─────────────┐                                             │
│  │ 风控检查    │                                             │
│  ├─────────────┤                                             │
│  │ ✓ 白名单    │ ALLOWED_SYMBOLS                            │
│  │ ✓ 仓位限制  │ MAX_POSITION_SIZE                          │
│  │ ✓ 测试网    │ USE_TESTNET                                │
│  └──────┬──────┘                                             │
│         ↓                                                    │
│  ┌─────────────┐     ┌─────────────┐                        │
│  │ 仓位计算    │────▶│ risk_mgmt   │                        │
│  │             │◀────│ position    │                        │
│  └──────┬──────┘     └─────────────┘                        │
│         ↓                                                    │
│  ┌─────────────┐     ┌─────────────┐                        │
│  │ 下单执行    │────▶│ CCXT API    │                        │
│  │ place_order │◀────│ create_order│                        │
│  └──────┬──────┘     └─────────────┘                        │
│         ↓                                                    │
│  ┌─────────────┐     ┌─────────────┐                        │
│  │ 记录交易    │────▶│ 本地存储    │                        │
│  │             │────▶│ 邮件通知    │                        │
│  └─────────────┘     └─────────────┘                        │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

**📂 核心脚本**：
| 脚本 | 功能 |
|-----|------|
| `Heablcoin.py` | place_order 工具 |
| `utils/risk_management.py` | 仓位计算 |
| `utils/trade_storage.py` | 交易记录 |

**⚠️ 重要提醒**：
- 默认启用测试网（USE_TESTNET=true）
- 必须配置 ALLOWED_SYMBOLS 白名单
- 单笔交易受 MAX_POSITION_SIZE 限制

---

### 🕐 时间轴 4：个人绩效分析流程

```
┌──────────────────────────────────────────────────────────────┐
│                    个人绩效分析管道                           │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────┐                                             │
│  │ 用户请求    │ "查看我的交易绩效"                          │
│  └──────┬──────┘                                             │
│         ↓                                                    │
│  ┌─────────────┐     ┌─────────────┐                        │
│  │ 数据获取    │────▶│ 交易所历史  │                        │
│  │             │────▶│ 本地记录    │                        │
│  └──────┬──────┘     └─────────────┘                        │
│         ↓                                                    │
│  ┌─────────────────────────────────────────────┐            │
│  │              分析模块                        │            │
│  ├──────────┬──────────┬──────────┬────────────┤            │
│  │ 绩效计算 │ 风险分析 │ 归因分析 │ 行为分析  │            │
│  │ PnL/胜率 │ 最大回撤 │ 盈亏归因 │ 交易习惯  │            │
│  └──────────┴──────────┴──────────┴────────────┘            │
│         │                                                    │
│         ↓                                                    │
│  ┌─────────────┐                                             │
│  │ 报告生成    │ Markdown / HTML / JSON                      │
│  └─────────────┘                                             │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

**📂 核心脚本**：
| 脚本 | 功能 |
|-----|------|
| `personal_analytics/mcp_tools.py` | MCP工具 |
| `personal_analytics/core.py` | 核心逻辑 |
| `personal_analytics/modules/performance.py` | 绩效计算 |
| `personal_analytics/modules/risk.py` | 风险分析 |
| `personal_analytics/modules/attribution.py` | 归因分析 |

---

### 🕐 时间轴 5：云端任务流程

```
┌──────────────────────────────────────────────────────────────┐
│                    云端任务调度管道                           │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────┐                                             │
│  │ MCP 发布    │ publish_cloud_task()                        │
│  └──────┬──────┘                                             │
│         ↓                                                    │
│  ┌─────────────┐                                             │
│  │ 任务队列    │ Redis / 本地文件                            │
│  │ (优先级)    │ URGENT > HIGH > NORMAL > LOW                │
│  └──────┬──────┘                                             │
│         ↓                                                    │
│  ┌─────────────┐                                             │
│  │ 调度器      │ CloudScheduler                              │
│  │ 定时触发    │ 心跳/队列消费/定时任务                       │
│  └──────┬──────┘                                             │
│         ↓                                                    │
│  ┌─────────────┐     ┌─────────────┐                        │
│  │ 执行器      │────▶│ AI Pipeline │                        │
│  │ TaskExecutor│────▶│ 通知发送    │                        │
│  │             │────▶│ 数据存储    │                        │
│  └──────┬──────┘     └─────────────┘                        │
│         ↓                                                    │
│  ┌─────────────┐                                             │
│  │ 结果回调    │ 状态更新 / 通知                             │
│  └─────────────┘                                             │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

**📂 核心脚本**：
| 脚本 | 功能 |
|-----|------|
| `cloud/mcp_tools.py` | MCP工具 |
| `cloud/scheduler.py` | 定时调度 |
| `cloud/task_executor.py` | 任务执行 |
| `cloud/enhanced_publisher.py` | 增强发布器 |
| `qinglong_worker.py` | 青龙Worker |

---

# 第三部分：核心文件清单

## 📁 按功能分类

### 🎯 系统入口（3个文件）
| 文件路径 | 功能说明 |
|---------|---------|
| `Heablcoin.py` | MCP Server 主入口，注册所有工具 |
| `Heablcoin-test.py` | 终端测试入口，无需MCP客户端 |
| `qinglong_worker.py` | 云端监控Worker |

### 📊 市场分析（18个文件）
| 文件路径 | 功能说明 |
|---------|---------|
| `market_analysis/core.py` | 分析核心逻辑 |
| `market_analysis/data_provider.py` | 数据获取 |
| `market_analysis/mcp_tools.py` | MCP工具注册 |
| `market_analysis/indicators/trend_indicators.py` | 趋势指标 |
| `market_analysis/indicators/momentum_indicators.py` | 动量指标 |
| `market_analysis/indicators/volatility_indicators.py` | 波动率指标 |
| `market_analysis/indicators/volume_indicators.py` | 成交量指标 |
| `market_analysis/modules/technical_summary.py` | 技术总结 |
| `market_analysis/modules/sentiment.py` | 情绪分析 |
| `market_analysis/modules/trading_signals.py` | 信号生成 |
| `market_analysis/modules/patterns.py` | 形态识别 |
| `market_analysis/modules/market_structure.py` | 市场结构 |

### 💼 个人绩效（15个文件）
| 文件路径 | 功能说明 |
|---------|---------|
| `personal_analytics/core.py` | 绩效核心逻辑 |
| `personal_analytics/data_provider.py` | 数据获取 |
| `personal_analytics/mcp_tools.py` | MCP工具 |
| `personal_analytics/modules/performance.py` | 绩效计算 |
| `personal_analytics/modules/risk.py` | 风险分析 |
| `personal_analytics/modules/attribution.py` | 归因分析 |
| `personal_analytics/modules/behavior.py` | 行为分析 |
| `personal_analytics/modules/portfolio.py` | 组合分析 |

### ☁️ 云端任务（10个文件）
| 文件路径 | 功能说明 |
|---------|---------|
| `cloud/api_manager.py` | 多API管理 |
| `cloud/scheduler.py` | 定时调度 |
| `cloud/task_executor.py` | 任务执行 |
| `cloud/enhanced_publisher.py` | 增强发布器 |
| `cloud/task_manager.py` | 任务管理 |
| `cloud/mcp_tools.py` | MCP工具 |

### 🧠 AI编排（7个文件）
| 文件路径 | 功能说明 |
|---------|---------|
| `orchestration/router.py` | 任务路由 |
| `orchestration/providers.py` | AI提供商 |
| `orchestration/ai_roles.py` | AI角色定义 |
| `orchestration/tasks.py` | 任务定义 |
| `orchestration/mcp_tools.py` | MCP工具 |

### 🔧 工具模块（10个文件）
| 文件路径 | 功能说明 |
|---------|---------|
| `utils/smart_logger.py` | 智能日志 |
| `utils/smart_cache.py` | 智能缓存 |
| `utils/risk_management.py` | 风险管理 |
| `utils/exchange_adapter.py` | 交易所适配 |
| `utils/backtesting.py` | 回测引擎 |
| `utils/notifier.py` | 通知工具 |
| `utils/performance_monitor.py` | 性能监控 |

### 💾 存储模块（6个文件）
| 文件路径 | 功能说明 |
|---------|---------|
| `storage/base.py` | 存储基类 |
| `storage/file_adapter.py` | 文件存储 |
| `storage/redis_adapter.py` | Redis存储 |
| `storage/email_adapter.py` | 邮件发送 |
| `storage/notion_adapter.py` | Notion同步 |

### 🧪 测试模块（12个文件）
| 文件路径 | 功能说明 |
|---------|---------|
| `tests/run_tests.py` | 测试运行器 |
| `tests/test_integration_simple.py` | 简单集成测试 |
| `tests/test_integration_full.py` | 完整集成测试 |
| `tests/test_mcp_tools.py` | MCP工具测试 |
| `tests/test_smart_cache.py` | 缓存测试 |
| `tests/test_smart_logger.py` | 日志测试 |

---

# 第四部分：数据流转图

## 🎯 关键数据文件流转图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           数据流转全景图                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  外部数据源                      核心处理                     输出目标       │
│  ══════════                    ════════                    ════════       │
│                                                                             │
│  ┌───────────┐                ┌───────────┐               ┌───────────┐   │
│  │ Binance   │───────────────▶│ CCXT      │               │ 日志文件   │   │
│  │ API       │                │ 统一接口   │               │ logs/      │   │
│  └───────────┘                └─────┬─────┘               └───────────┘   │
│                                     │                            ▲         │
│  ┌───────────┐                      ▼                            │         │
│  │ OKX/Bybit │              ┌─────────────┐                      │         │
│  │ (扩展)    │─ ─ ─ ─ ─ ─ ─▶│ 数据处理层  │──────────────────────┤         │
│  └───────────┘              │ DataProvider│                      │         │
│                             └─────┬─────┘                        │         │
│                                   │                              │         │
│  ┌───────────┐                    ▼                              │         │
│  │ .env      │              ┌─────────────┐               ┌───────────┐   │
│  │ 配置文件   │─────────────▶│ 业务逻辑层  │──────────────▶│ 本地存储   │   │
│  └───────────┘              │ Analysis    │               │ data/     │   │
│                             │ Analytics   │               │ storage/  │   │
│  ┌───────────┐              │ Trading     │               └───────────┘   │
│  │ 用户输入   │─────────────▶│             │                      │         │
│  │ (MCP)     │              └─────┬─────┘                        │         │
│  └───────────┘                    │                              │         │
│                                   ▼                              ▼         │
│                             ┌─────────────┐               ┌───────────┐   │
│                             │ 输出格式化   │──────────────▶│ 邮件通知   │   │
│                             │ JSON/MD/HTML│               │ SMTP      │   │
│                             └─────────────┘               └───────────┘   │
│                                   │                              │         │
│                                   ▼                              ▼         │
│                             ┌─────────────┐               ┌───────────┐   │
│                             │ MCP 响应    │               │ Redis     │   │
│                             │ 返回用户    │               │ 云端队列   │   │
│                             └─────────────┘               └───────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 📊 数据流向表格

| 数据类型 | 来源 | 处理模块 | 输出目标 |
|---------|------|---------|---------|
| 行情数据 | 交易所API | market_analysis | MCP响应/图表 |
| K线数据 | CCXT fetch_ohlcv | indicators | 技术指标 |
| 账户余额 | 交易所API | personal_analytics | MCP响应 |
| 交易历史 | 交易所/本地 | personal_analytics | 绩效报告 |
| 用户配置 | .env | 全局 | 各模块 |
| 任务数据 | MCP请求 | cloud | Redis/执行结果 |
| 日志数据 | 各模块 | smart_logger | logs/*.log |
| 通知内容 | 各模块 | notifier | 邮件/Telegram |

---

# 第五部分：使用说明

## 📌 如何查找特定功能的代码

### 1. 按功能查找
```
市场分析相关  →  market_analysis/
个人绩效相关  →  personal_analytics/
云端任务相关  →  cloud/
AI编排相关   →  orchestration/
工具函数相关  →  utils/
存储相关     →  storage/
测试相关     →  tests/
```

### 2. 按文件类型查找
```
MCP工具定义   →  */mcp_tools.py
核心逻辑     →  */core.py
数据获取     →  */data_provider.py
子功能模块   →  */modules/*.py
```

## 📌 如何追踪数据流向

1. **从MCP工具入手**：查看 `*/mcp_tools.py` 中的工具函数
2. **追踪调用链**：工具函数 → core.py → data_provider.py → 交易所API
3. **查看输出格式**：返回值通常为 JSON 字符串

## 📌 如何理解模块依赖关系

```
Heablcoin.py (主入口)
    │
    ├──▶ market_analysis/mcp_tools.py
    │        └──▶ market_analysis/core.py
    │                 └──▶ market_analysis/data_provider.py
    │
    ├──▶ personal_analytics/mcp_tools.py
    │        └──▶ personal_analytics/core.py
    │
    ├──▶ cloud/mcp_tools.py
    │        └──▶ cloud/scheduler.py
    │        └──▶ cloud/task_executor.py
    │
    └──▶ utils/ (被所有模块依赖)
             ├──▶ smart_logger.py
             ├──▶ smart_cache.py
             └──▶ risk_management.py
```

## 📌 快速上手检查清单

```
□ 克隆代码仓库
□ 配置 .env 文件（API密钥）
□ 安装 Python 依赖
□ 运行快速测试 (python tests/run_tests.py --quick)
□ 启动 MCP Server 验证
□ 在 Claude Desktop 中测试基本功能
```

## 📌 常见问题排查

| 问题 | 可能原因 | 解决方案 |
|-----|---------|---------|
| MCP连接失败 | stdout被污染 | 检查是否有print语句 |
| 交易所API报错 | API密钥无效 | 检查.env配置 |
| 导入模块失败 | 依赖未安装 | pip install -r requirements.txt |
| 缓存不生效 | TTL过期 | 检查smart_cache配置 |

---

## 📚 相关文档链接

- [安装指南](installation.md)
- [配置指南](configuration.md)
- [API参考](../developer/API参考.md)
- [架构设计](architecture.md)
- [MCP使用指南](MCP使用指南.md)
- [升级日志](../../升级.md)
- [路线图](../developer/路线图.md)

---

> 📝 **文档维护说明**：本文档应随代码更新同步维护，建议每次重大版本更新后重新生成。

---

*免责声明：本文档仅供学习与参考，加密货币交易风险极高，盈亏自负。*
