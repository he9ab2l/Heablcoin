############################################################
# ğŸ“˜ æ–‡ä»¶è¯´æ˜ï¼šLLMè·¯ç”±æµ‹è¯•
# æœ¬æ–‡ä»¶å®ç°çš„åŠŸèƒ½ï¼šAIè·¯ç”±åŠŸèƒ½æµ‹è¯•
#
# ğŸ“‹ ç¨‹åºæ•´ä½“ä¼ªä»£ç ï¼ˆä¸­æ–‡ï¼‰ï¼š
# 1. åˆå§‹åŒ–ä¾èµ–æ¨¡å—å’Œé…ç½®
# 2. å®šä¹‰æ ¸å¿ƒç±»å’Œå‡½æ•°
# 3. å®ç°ä¸»è¦ä¸šåŠ¡é€»è¾‘
# 4. æä¾›å¯¹å¤–æ¥å£
# 5. å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•
#
# ğŸ”„ ç¨‹åºæµç¨‹å›¾ï¼ˆé€»è¾‘æµï¼‰ï¼š
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  æµ‹è¯•ç”¨ä¾‹    â”‚
# â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
#        â†“
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  æ‰§è¡Œæ–­è¨€    â”‚
# â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
#        â†“
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  è¾“å‡ºç»“æœ    â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# ğŸ“Š æ•°æ®ç®¡é“è¯´æ˜ï¼š
# æ•°æ®æµå‘ï¼šè¾“å…¥æº â†’ æ•°æ®å¤„ç† â†’ æ ¸å¿ƒç®—æ³• â†’ è¾“å‡ºç›®æ ‡
#
# ğŸ§© æ–‡ä»¶ç»“æ„ï¼š
# - å‡½æ•°: test_router_fallback_echo
#
# ğŸ”— ä¸»è¦ä¾èµ–ï¼šorchestration
#
# ğŸ•’ åˆ›å»ºæ—¶é—´ï¼š2025-12-18
############################################################

import os
import sys

REPO_ROOT = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
SRC_DIR = os.path.join(REPO_ROOT, "src")
sys.path.insert(0, REPO_ROOT)
sys.path.insert(0, SRC_DIR)

from core.orchestration.ai_router import LLMRouter


def test_router_fallback_echo():
    router = LLMRouter()  # without keys will fall back to echo
    res = router.generate(prompt="ping", system="test", max_tokens=10)
    assert "content" in res
    assert res.get("provider") == "echo" or res.get("success") is False
