# Heablcoin æµ‹è¯•å¥—ä»¶

å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼Œç”¨äºéªŒè¯æ‰€æœ‰ä¼˜åŒ–åŠŸèƒ½å’ŒMCPå·¥å…·ã€‚

## ğŸ“ æµ‹è¯•ç»“æ„

```
tests/
â”œâ”€â”€ __init__.py                    # æµ‹è¯•æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ README.md                      # æœ¬æ–‡æ¡£
â”œâ”€â”€ run_tests.py                   # ç»Ÿä¸€æµ‹è¯•å…¥å£ â­
â”‚
â”œâ”€â”€ å•å…ƒæµ‹è¯•/
â”‚   â”œâ”€â”€ test_smart_logger.py       # æ™ºèƒ½æ—¥å¿—ç³»ç»Ÿæµ‹è¯•
â”‚   â”œâ”€â”€ test_smart_cache.py        # æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿæµ‹è¯•
â”‚   â””â”€â”€ test_mcp_tools.py          # MCPå·¥å…·åŠŸèƒ½æµ‹è¯•
â”‚
â””â”€â”€ é›†æˆæµ‹è¯•/
    â”œâ”€â”€ test_integration_simple.py # ç®€å•é›†æˆæµ‹è¯•ï¼ˆå¿«é€Ÿï¼‰
    â””â”€â”€ test_integration_full.py   # å®Œæ•´é›†æˆæµ‹è¯•ï¼ˆå…¨é¢ï¼‰
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
cd tests
python run_tests.py
```

### 2. å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èé¦–æ¬¡è¿è¡Œï¼‰

```bash
python run_tests.py --file test_integration_simple.py
```

### 3. è¿è¡Œç‰¹å®šæµ‹è¯•å¥—ä»¶

```bash
# åªè¿è¡Œå•å…ƒæµ‹è¯•
python run_tests.py unit

# åªè¿è¡Œé›†æˆæµ‹è¯•
python run_tests.py integration
```

### 4. è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶

```bash
python run_tests.py --file test_smart_cache.py
```

### 5. åˆ—å‡ºæ‰€æœ‰å¯ç”¨æµ‹è¯•

```bash
python run_tests.py --list
```

## æµ‹è¯•å¥—ä»¶è¯´æ˜

### å•å…ƒæµ‹è¯• (Unit Tests)

#### `test_smart_logger.py` - æ™ºèƒ½æ—¥å¿—ç³»ç»Ÿ
- SmartLogger åˆ›å»ºå’Œåˆå§‹åŒ–
- 5ä¸ªæ—¥å¿—é€šé“ï¼ˆsystem/trading/analysis/error/performanceï¼‰
- æ€§èƒ½è®°å½•å’Œç»Ÿè®¡
- æ€§èƒ½è£…é¥°å™¨
- å…¨å±€å•ä¾‹æ¨¡å¼

**æµ‹è¯•æ•°é‡**: 5ä¸ªæµ‹è¯•

#### `test_smart_cache.py` - æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
- åŸºæœ¬ç¼“å­˜æ“ä½œï¼ˆget/setï¼‰
- TTLè¿‡æœŸæœºåˆ¶
- ç¼“å­˜æœªå‘½ä¸­å¤„ç†
- ç¼“å­˜ç»Ÿè®¡ï¼ˆå‘½ä¸­ç‡ã€é”®æ•°ï¼‰
- ç¼“å­˜æ¸…é™¤ï¼ˆå…¨éƒ¨/æ¨¡å¼åŒ¹é…ï¼‰
- ç¼“å­˜è£…é¥°å™¨
- å…¨å±€å•ä¾‹æ¨¡å¼

**æµ‹è¯•æ•°é‡**: 7ä¸ªæµ‹è¯•

#### `test_mcp_tools.py` - MCPå·¥å…·åŠŸèƒ½
- MCPå·¥å…·å®‰å…¨è£…é¥°å™¨
- stdoutéš”ç¦»æœºåˆ¶
- ç¯å¢ƒå˜é‡è¾…åŠ©å‡½æ•°
- é€šçŸ¥å¼€å…³é€»è¾‘
- å®‰å…¨æ–‡ä»¶åç”Ÿæˆ

**æµ‹è¯•æ•°é‡**: 5ä¸ªæµ‹è¯•

### é›†æˆæµ‹è¯• (Integration Tests)

#### `test_integration_simple.py` - ç®€å•é›†æˆæµ‹è¯•
å¿«é€ŸéªŒè¯æ ¸å¿ƒåŠŸèƒ½ï¼Œé€‚åˆæ—¥å¸¸å¼€å‘ã€‚

- å·¥å…·æ¨¡å—å¯¼å…¥
- æ—¥å¿—å’Œç¼“å­˜é›†æˆ
- æ€§èƒ½ç›‘æ§
- å¼‚å¸¸å¤„ç†
- æ—¥å¿—æ–‡ä»¶åˆ›å»º

**æµ‹è¯•æ•°é‡**: 5ä¸ªæµ‹è¯•  
**è¿è¡Œæ—¶é—´**: ~1ç§’

#### `test_integration_full.py` - å®Œæ•´é›†æˆæµ‹è¯•
å…¨é¢æµ‹è¯•æ‰€æœ‰ä¼˜åŒ–åŠŸèƒ½çš„ååŒå·¥ä½œã€‚

- P0-1: stdoutéš”ç¦»æœºåˆ¶
- P0-2: å…¨å±€å¼‚å¸¸ä¿æŠ¤
- P0-3: æ™ºèƒ½æ—¥å¿—ç³»ç»Ÿ
- P1-1: æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
- æ—¥å¿—+ç¼“å­˜ååŒå·¥ä½œ
- é”™è¯¯æ—¥å¿—+ç¼“å­˜ååŒ
- æ‰€æœ‰ä¼˜åŒ–åŠŸèƒ½çŠ¶æ€

**æµ‹è¯•æ•°é‡**: 7ä¸ªæµ‹è¯•  
**è¿è¡Œæ—¶é—´**: ~2ç§’

## æµ‹è¯•è¦†ç›–

### P0 - ç¨³å®šæ€§åŠŸèƒ½
- stdoutéš”ç¦» (é˜²æ­¢æ±¡æŸ“MCPåè®®)
- å¼‚å¸¸æ•è· (é˜²æ­¢MCPå´©æºƒ)
- æ™ºèƒ½æ—¥å¿— (å¤šé€šé“ + æ€§èƒ½ç›‘æ§)

### P1 - æ€§èƒ½åŠŸèƒ½
- æ™ºèƒ½ç¼“å­˜ (TTL + ç»Ÿè®¡)
- æ€§èƒ½ç›‘æ§ (æ…¢æŸ¥è¯¢æ£€æµ‹)

### é›†æˆåŠŸèƒ½
- æ—¥å¿—å’Œç¼“å­˜ååŒ
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—
- æ€§èƒ½è£…é¥°å™¨

## ä½¿ç”¨åœºæ™¯

### å¼€å‘æ—¶
```bash
# å¿«é€ŸéªŒè¯æ”¹åŠ¨
python run_tests.py --file test_integration_simple.py

# éªŒè¯ç‰¹å®šæ¨¡å—
python run_tests.py --file test_smart_cache.py
```

### æäº¤å‰
```bash
# è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•
python run_tests.py unit
```

### å‘å¸ƒå‰
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
python run_tests.py all
```

## âœ… é¢„æœŸè¾“å‡º

### æˆåŠŸç¤ºä¾‹
```
============================================================
ğŸ§ª ç®€å•é›†æˆæµ‹è¯•
============================================================

ğŸ“ æµ‹è¯•1: å·¥å…·æ¨¡å—å¯¼å…¥
âœ… é€šè¿‡: å·¥å…·æ¨¡å—å¯¼å…¥æˆåŠŸ

ğŸ“ æµ‹è¯•2: æ—¥å¿—å’Œç¼“å­˜é›†æˆ
âœ… é€šè¿‡: æ—¥å¿—å’Œç¼“å­˜é›†æˆæ­£å¸¸ (å‘½ä¸­ç‡: 66.7%)

...

============================================================
ğŸ“Š æµ‹è¯•ç»“æœ: 5 é€šè¿‡, 0 å¤±è´¥
============================================================
```

### å¤±è´¥ç¤ºä¾‹
```
ğŸ“ æµ‹è¯•3: æ€§èƒ½ç›‘æ§
âŒ å¤±è´¥: 'slow_function' not in stats

============================================================
ğŸ“Š æµ‹è¯•ç»“æœ: 2 é€šè¿‡, 1 å¤±è´¥
============================================================
```

## ğŸ”§ æ•…éšœæ’æŸ¥

### å¯¼å…¥é”™è¯¯
```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
cd d:/MCP
python tests/run_tests.py
```

### æƒé™é”™è¯¯
```bash
# ç¡®ä¿logsç›®å½•å¯å†™
mkdir logs
chmod 755 logs
```

### ä¾èµ–ç¼ºå¤±
```bash
# å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt
```

## ğŸ“ æ·»åŠ æ–°æµ‹è¯•

### 1. åˆ›å»ºæµ‹è¯•æ–‡ä»¶
```python
# tests/test_new_feature.py
import sys
import os

sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

def test_new_feature():
    """æµ‹è¯•æ–°åŠŸèƒ½"""
    print("\nğŸ“ æµ‹è¯•1: æ–°åŠŸèƒ½")
    
    try:
        # æµ‹è¯•ä»£ç 
        assert True, "æµ‹è¯•å¤±è´¥åŸå› "
        
        print("âœ… é€šè¿‡: æ–°åŠŸèƒ½æ­£å¸¸")
        return True
    except Exception as e:
        print(f"âŒ å¤±è´¥: {e}")
        return False

def run_all_tests():
    tests = [test_new_feature]
    passed = sum(1 for test in tests if test())
    failed = len(tests) - passed
    
    print(f"\nğŸ“Š æµ‹è¯•ç»“æœ: {passed} é€šè¿‡, {failed} å¤±è´¥")
    return failed == 0

if __name__ == "__main__":
    success = run_all_tests()
    sys.exit(0 if success else 1)
```

### 2. æ·»åŠ åˆ°æµ‹è¯•å¥—ä»¶
ç¼–è¾‘ `run_tests.py`ï¼Œåœ¨ `TEST_SUITES` ä¸­æ·»åŠ æ–°æµ‹è¯•æ–‡ä»¶ã€‚

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æµ‹è¯•éš”ç¦»**: æ¯ä¸ªæµ‹è¯•åº”è¯¥ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•
2. **æ¸…ç†èµ„æº**: ä½¿ç”¨ä¸´æ—¶ç›®å½•ï¼Œæµ‹è¯•åæ¸…ç†
3. **æ˜ç¡®æ–­è¨€**: ä½¿ç”¨æ¸…æ™°çš„æ–­è¨€æ¶ˆæ¯
4. **å¿«é€Ÿåé¦ˆ**: å•å…ƒæµ‹è¯•åº”è¯¥å¿«é€Ÿå®Œæˆï¼ˆ<1ç§’ï¼‰
5. **å®Œæ•´è¦†ç›–**: é›†æˆæµ‹è¯•éªŒè¯å®é™…ä½¿ç”¨åœºæ™¯

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [å‡çº§æ–‡æ¡£](../å‡çº§.md) - æŸ¥çœ‹ä¼˜åŒ–åŠŸèƒ½è¯¦æƒ…
- [ä¸»README](../README.md) - é¡¹ç›®æ€»è§ˆ
- [ä½¿ç”¨æŒ‡å—](../docs/user/MCPä½¿ç”¨æŒ‡å—.md) - MCPä½¿ç”¨è¯´æ˜

## ğŸ“ æ”¯æŒ

å¦‚æœæµ‹è¯•å¤±è´¥ï¼š
1. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ª
2. æ£€æŸ¥ `logs/` ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶
3. è¿è¡Œ `python run_tests.py --file <å¤±è´¥çš„æµ‹è¯•>` å•ç‹¬è°ƒè¯•
4. æŸ¥çœ‹ç›¸å…³æ¨¡å—çš„æºä»£ç 

---

**æœ€åæ›´æ–°**: 2024-12-16  
**æµ‹è¯•è¦†ç›–ç‡**: P0 (100%), P1 (100%)
